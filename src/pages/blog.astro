---
import { format } from "date-fns";
import { getCollection } from "astro:content";
import { isAfter, isBefore } from "date-fns";
import BaseLayout from "../layouts/BaseLayout.astro";
const allPosts = await getCollection("posts");
---

<BaseLayout pageTitle="Aro Andriamaro | Blog">
  <h1>All posts</h1>
  <div class="flex flex-col not-prose gap-6">
    {
      [...allPosts]
        .sort((a, b) => {
          if (isAfter(new Date(a.data.pubDate), new Date(b.data.pubDate)))
            return -1;
          if (isBefore(new Date(a.data.pubDate), new Date(b.data.pubDate)))
            return 1;
          return 0;
        })
        .map((post) => (
          <div class="card card-bordered shadow-sm card-compact">
            <div class="card-body">
              <small>
                üóìÔ∏è {format(new Date(post.data.pubDate), "MMM do, yyyy")}
              </small>
              <h2 class="card-title">
                <a href={`/posts/${post.slug}`}>{post.data.title}</a>
              </h2>
              <p>{post.data.description}</p>
              <div class="card-actions justify-end">
                <a class="btn btn-link btn-sm" href={`/posts/${post.slug}`}>
                  Read more
                </a>
              </div>
            </div>
          </div>
        ))
    }
  </div>
</BaseLayout>
